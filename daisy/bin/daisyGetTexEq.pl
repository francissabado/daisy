#!/usr/bin/perl

# This script extracts a chosen equation from files generated by the 
# daisyHarvestTexEq.pl command
#
# The equation is collected by their corresponding numbers (labels)
# Output is the standard output
#
# Example
#
# %% Extract equation number 4 from the harvestedEqs.tex file
# 
# daisyGetTexEq harvestedEqs.tex 4
#
# (c) Niklas U Andersson, Electronics Systems, Linköping University
#
# Change History
#
# 2010-12-11 First Release

$texFile=$ARGV[0]; # input texFile
$eqNumber=$ARGV[1]; # equation number to retrieve

open(FILE_IN, "$texFile");

@eqSection = ();
$eqFound = 0;

while(<FILE_IN>)
{

    if (
	(( (m/\\begin{equation}/) || (m/\\begin{eqnarray}/)) && (!(m/\%/))) 
	|| 
	($insideEquation == 1))
    {
	
	$insideEquation = 1;	
	
	if (m/\\label{eq:$eqNumber}/)
	{
	    s/^\s//;
            #print("$_\n");
	    push(@eqSection,"$_");
	    $eqFound = 1;
	    print("\n\nJippiii! Got'ya!\n\n")
	    }
	else
        {
	    s/^\s//;
	    push(@eqSection,"$_");
	}
	
	# keep pushing until you find the \end{equation}
    }
    
    if ((m/\\end{equation}/) || (m/\\end{eqnarray}/)) 
    {
	#push(@eqSection,"$_\n");
	
	if ($eqFound == 1)
	{
	    print("@eqSection\n");
	}
	$insideEquation = 0;
        $eqFound = 0;
	@eqSection = ();
    }
}

print("\n");
print("\n");
print("\n");

#print("\n");
close(FILE_IN);
