function[mag,fas,offset] = daisyExtractSine(y, n, WkT)% [mag,fas,offset]=extract_sinusoids(y,n,WkT)%% Uses a least squares fit to find the amplitudes, phases,% and offsets of a sum of sinusoids of known frequencies WkT% y(n) is the measured data and n is the time index. % The phases are extracted with reference to the first value% of n.%aa = [];for k = 1:length(WkT)     aa = [aa sin(WkT(k)*n)' cos(WkT(k)*n)'];	endaa = [aa ones(length(n),1)];AA = aa'*aa;bb = aa'*y';E = AA\bb;mag = [];fas = [];offset = [];for k = 1:2:length(E)-1    mag = [mag sqrt(E(k)^2+E(k+1)^2)];    if E(k)<0        fas = [fas atan(E(k+1)/E(k))+pi];	    else        fas = [fas atan(E(k+1)/E(k))];	    endendoffset = E(length(E));